<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Your Spot Today | Register Now</title>
    <link rel="icon" type="image/png" href="/images/favicon.ico">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/nav-footer.css" rel="stylesheet">
    <style>
        body { background-color: #051a6b !important; }
        .register-section {
            padding: 50px 15%;
            background-image: url(/images/snowpark-skis-headerbg2.jpg);
            background-repeat: no-repeat;
            background-size: cover;
            color: white;
        }
        .register-form {
            padding: 50px 15%;
            background-color: rgba(185,185,185,0.13);
            border: 2px solid gray;
            border-radius: 10px;
        }
        label { font-size: 15px; }
        @media (max-width:768px){
            .register-section, .register-form { padding: 50px 5%; }
        }
    </style>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark">
    <div class="container">
        <a class="navbar-brand mx-auto" th:href="@{/}">
            <img src="/images/scope-india-logo-bird.png" alt="Logo">
        </a>
        <div class="collapse navbar-collapse justify-content-between" id="navbarNav">
            <ul class="navbar-nav me-auto">
                <li class="nav-item"><a class="nav-link active" th:href="@{/}">Home</a></li>
                <li class="nav-item"><a class="nav-link" th:href="@{/about}">About Us</a></li>
            </ul>
            <ul class="navbar-nav ms-auto">
                <li class="nav-item"><a class="nav-link" th:href="@{/contact}">Contact</a></li>
                <li class="nav-item"><a class="nav-link" th:href="@{/login}">Login</a></li>
                <li class="mt-2 nav-item"><a class="register-btn" th:href="@{/register}">Register</a></li>
            </ul>
        </div>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
    </div>
</nav>

<!-- Registration Form -->
<div class="register-section">
    <h1 class="text-center text-warning mb-5">Register Now</h1>
    <div class="register-form">
        <h2 class="text-center">Student Registration</h2>
        <form id="registrationForm" action="/register" method="post" enctype="multipart/form-data">
            <div class="mb-3">
                <label>First Name</label>
                <input type="text" class="form-control" name="firstname" required>
            </div>
            <div class="mb-3">
                <label>Last Name</label>
                <input type="text" class="form-control" name="lastname" required>
            </div>
            <div class="mb-3">
                <label>Gender</label>
                <select class="form-control" name="gender" required>
                    <option value="">Select</option>
                    <option>Male</option>
                    <option>Female</option>
                    <option>Other</option>
                </select>
            </div>
            <div class="mb-3">
                <label>Date of Birth</label>
                <input type="date" class="form-control" name="dob" required>
            </div>
            <div class="mb-3">
                <label>Email</label>
                <input type="email" class="form-control" name="email" required>
            </div>
            <div class="mb-3">
                <label>Phone Number</label>
                <input type="text" class="form-control" name="phone" required>
            </div>
            <div class="mb-3">
                <label>Country</label>
                <select class="form-control" id="country" name="country" required>
                    <option value="">Select Country</option>
                </select>
            </div>
            <div class="mb-3">
                <label>State</label>
                <select class="form-control" id="state" name="state" required>
                    <option value="">Select State</option>
                </select>
            </div>
            <div class="mb-3">
                <label>City</label>
                <select class="form-control" id="city" name="city" required>
                    <option value="">Select City</option>
                </select>
            </div>
            <div class="mb-3">
                <label>Hobbies</label>
                <div class="row">
                    <div class="col-6 col-md-4"><input type="checkbox" name="hobbies" value="Reading"> Reading</div>
                    <div class="col-6 col-md-4"><input type="checkbox" name="hobbies" value="Writing"> Writing</div>
                    <div class="col-6 col-md-4"><input type="checkbox" name="hobbies" value="Traveling"> Traveling</div>
                    <div class="col-6 col-md-4"><input type="checkbox" name="hobbies" value="Sports"> Sports</div>
                    <div class="col-6 col-md-4"><input type="checkbox" name="hobbies" value="Music"> Music</div>
                    <div class="col-6 col-md-4"><input type="checkbox" name="hobbies" value="Movies"> Movies</div>
                    <div class="col-6 col-md-4"><input type="checkbox" name="hobbies" value="Others"> Others</div>
                </div>
            </div>
            <div class="mb-3">
                <label>Profile Photo</label>
                <input type="file" name="file" accept="image/*" class="form-control" required>
            </div>
            <button type="submit" class="btn btn-success w-100">Register</button>
            <div id="success-message" class="mt-3 text-center"></div>
        </form>
    </div>
</div>

<!-- Footer -->
<footer class="footer text-white text-center py-5 mt-5">
    <div class="container">
        <div class="row text-center">
            <div class="col-md-4 mb-3"><h3 class="fw-bold">1000+</h3><p>STUDENTS TRAINED EVERY YEAR</p></div>
            <div class="col-md-4 mb-3"><h3 class="fw-bold">30+</h3><p>COMPUTER COURSES</p></div>
            <div class="col-md-4 mb-3"><h3 class="fw-bold">95%</h3><p>PLACED EVERY YEAR</p></div>
        </div>
        <img src="/images/scope-india-logo-home-page.png" alt="Logo">
        <p>Technopark | Thampanoor | Kaloor | Nagercoil</p>
        <img src="/images/iso_iaflogo.png" width="450" height="120" alt="ISO 9001 Certified">
        <p>An ISO 9001:2015 Certified Company</p>
        <p>Â© Suffix E Solutions 2007-2025 | info@scopeindia.org</p>
    </div>
</footer>

<!-- Scripts -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$(document).ready(function(){
    const apiKey = "NU5mQ2lDbk9CZVJteWhBQTY0YXBKQ0pBbVBYUUNiVVF0V1Q3YzJGVA==";
    const headers = { "X-CSCAPI-KEY": apiKey };
    const countryDropdown = $("#country"), stateDropdown = $("#state"), cityDropdown = $("#city");

    function fetchData(url, dropdown, defaultText, callback) {
        $.ajax({
            url: url,
            method: "GET",
            headers: headers,
            success: function(data) {
                dropdown.html(`<option value="">${defaultText}</option>`);
                data.forEach(callback);
            },
            error: function() {
                console.error(`Error fetching ${defaultText}`);
            }
        });
    }

    // Load countries on page load
    fetchData("https://api.countrystatecity.in/v1/countries", countryDropdown, "Select Country",
        c => countryDropdown.append(`<option value="${c.name}" data-code="${c.iso2}">${c.name}</option>`)
    );

    // When country changes, load states
    countryDropdown.change(function () {
        const countryCode = $(this).find(':selected').data('code');
        if (countryCode) {
            fetchData(`https://api.countrystatecity.in/v1/countries/${countryCode}/states`, stateDropdown, "Select State",
                s => stateDropdown.append(`<option value="${s.name}" data-code="${s.iso2}">${s.name}</option>`)
            );
        } else {
            stateDropdown.html('<option value="">Select State</option>');
        }
        cityDropdown.html('<option value="">Select City</option>');
    });

    // When state changes, load cities
    stateDropdown.change(function () {
        const countryCode = countryDropdown.find(':selected').data('code');
        const stateCode = $(this).find(':selected').data('code');
        if (countryCode && stateCode) {
            fetchData(`https://api.countrystatecity.in/v1/countries/${countryCode}/states/${stateCode}/cities`, cityDropdown, "Select City",
                city => cityDropdown.append(`<option value="${city.name}">${city.name}</option>`)
            );
        } else {
            cityDropdown.html('<option value="">Select City</option>');
        }
    });

    // Handle form submission with FormData for file upload
    $('#registrationForm').submit(function(e){
        e.preventDefault();

        const formData = new FormData(this); // include file and text inputs

        $.ajax({
            url: $(this).attr('action'),
            method: $(this).attr('method'),
            data: formData,
            processData: false,  // Important: do not let jQuery process data
            contentType: false,  // Important: tell jQuery not to set content-type header
            success: function(response){
                if(response.trim() === "success"){
                    $('#success-message').text("Successfully Registered!").css("color", "green");
                    $('#registrationForm')[0].reset();
                } else {
                    $('#success-message').text("Registration failed. Try again.").css("color", "red");
                }
            },
            error: function(){
                $('#success-message').text("Error submitting form.").css("color", "red");
            }
        });
    });
});
</script>


</body>
</html>
